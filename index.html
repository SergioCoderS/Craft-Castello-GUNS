<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Castello Guns</title>
<style>
body {
  margin:0; padding:0; font-family:Arial,sans-serif;
  background:url('background.png') no-repeat center center fixed;
  background-size:cover;
  color:#fff;
}
.header {
  text-align:center; font-size:48px; font-weight:bold; padding:20px 0;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(6px);
  letter-spacing:2px; text-shadow: 2px 2px 8px #000,0 0 10px #ff0000; color:#ff4444;
  font-family:"Georgia", serif; user-select:none;
}
.container { display:flex; min-height:100vh; flex-direction:row; }
.menu { width:220px; background: rgba(0,0,0,0.7); padding:20px; box-sizing:border-box; display:flex; flex-direction:column; gap:6px; }
.menu div { padding:12px; background: rgba(255,255,255,0.05); cursor:pointer; border-radius:6px; transition:0.2s; }
.menu div:hover, .menu .active { background: rgba(255,255,255,0.2); }
.content { flex:1; padding:20px; background: rgba(0,0,0,0.5); backdrop-filter: blur(10px); overflow-y:auto; }
.controls { display:flex; gap:16px; align-items:center; flex-wrap:wrap; margin-bottom:12px; }
.items { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:8px; }
.items .item { padding:10px; background: rgba(255,255,255,0.1); cursor:pointer; border-radius:6px; transition:0.2s; }
.items .item:hover { background: rgba(255,255,255,0.2); }
.items .active-item { outline: 2px solid #ff4444; }
.block { margin-top:15px; background: rgba(0,0,0,0.35); padding:15px; border-radius:8px; border:1px solid rgba(255,255,255,0.15); white-space:pre-line; }
label { display:inline-flex; align-items:center; gap:8px; }
input, select { padding:6px 8px; border-radius:6px; border:1px solid rgba(255,255,255,0.25); background: rgba(0,0,0,0.3); color:#fff; }
input[type="number"] { width:90px; }
.section-title { font-weight:bold; color:#ffdddd; margin-bottom:6px; display:inline-block; }
</style>
</head>
<body>

<div class="header">Castello Guns</div>

<div class="container">
  <div class="menu" id="menu">
    <div data-category="revolvers">Револьвери</div>
    <div data-category="rifles">Гвинтівки</div>
    <div data-category="repeaters">Ріпітери</div>
    <div data-category="shotguns">Дробовики</div>
    <div data-category="ingots">Злитки</div>
    <div data-category="parts">Запчастини</div>
  </div>

  <div class="content">
    <div class="controls">
      <label>Кількість: <input type="number" id="qty" value="1" min="1"></label>
      <label id="goldSelector" style="display:none;">Золото:
        <select id="goldOption">
          <option value="0">Золота руда (10)</option>
          <option value="1">Середній самородок (20)</option>
          <option value="2">Малий самородок (30)</option>
        </select>
      </label>
    </div>

    <div class="items" id="items"></div>

    <div class="block" id="summary">Виберіть предмет</div>
  </div>
</div>

<script>
// Дані
const data = {
  rifles: {
    "Гвинтівка Boltaction": { "Корпус важкої зброї":1, "Дуло":1, "Дерево":25, "Злиток сталі":4 },
    "Гвинтівка Springfield": { "Корпус важкої зброї":1, "Дуло":1, "Дерево":20, "Злиток сталі":4 }
  },
  shotguns: {
    "Дробовик Double Barrel": { "Корпус важкої зброї":1, "Дуло":2, "Дерево":5, "Злиток сталі":3 },
    "Дробовик Repeating": { "Корпус важкої зброї":1, "Дуло":1, "Дерево":5, "Злиток сталі":2 },
    "Дробовик Semi-Auto": { "Корпус важкої зброї":1, "Дуло":1, "Дерево":5, "Злиток сталі":2 }
  },
  revolvers: {
    "Cattleman": { "Корпус легкої зброї":1, "Дуло":1, "Барабан":1, "Дерево":1, "Злиток сталі":2 },
    "Double Action": { "Корпус легкої зброї":1, "Дуло":1, "Барабан":1, "Дерево":1, "Злиток сталі":2 },
    "Double Action Gambler": { "Корпус легкої зброї":1, "Дуло":1, "Барабан":1, "Дерево":1, "Злиток сталі":2 },
    "Lemat": { "Корпус легкої зброї":1, "Дуло":2, "Барабан":1, "Дерево":1, "Злиток сталі":2 },
    "Navy": { "Корпус легкої зброї":1, "Дуло":1, "Барабан":1, "Дерево":1, "Злиток сталі":3, "Злиток золота":1, "Злиток срібла":1 },
    "Schofield": { "Корпус легкої зброї":1, "Дуло":1, "Барабан":1, "Дерево":1, "Злиток сталі":2 }
  },
  repeaters: {
    "Carbine": { "Корпус важкої зброї":1, "Дуло":1, "Дерево":5, "Злиток сталі":3 },
    "Evans": { "Корпус важкої зброї":1, "Дуло":1, "Дерево":10, "Злиток сталі":3 },
    "Lancaster": { "Корпус важкої зброї":1, "Дуло":2, "Дерево":5, "Злиток сталі":3 },
    "Litchfield": { "Корпус важкої зброї":1, "Дуло":2, "Дерево":5, "Злиток сталі":3 }
  },
  parts: {
    "Корпус важкої зброї": { "Злиток заліза":2, "Злиток сталі":2, "Дерево":10 },
    "Корпус легкої зброї": { "Злиток заліза":1, "Злиток сталі":1, "Дерево":5 },
    "Барабан": { "Злиток сталі":1 },
    "Дуло": { "Злиток сталі":1 },
    "Глиняна форма": { "Глина":5, "Вугілля":5 }   // ➜ ДОДАНО ФОРМУ
  },
  ingots: {
    "Злиток сталі": { "Злиток заліза":1, "Вугілля":5, "Глиняна форма":1 },
    "Злиток заліза": { "Залізна руда":10, "Вугілля":5, "Глиняна форма":1 },
    "Злиток золота": [
      { "Золота руда":10, "Вугілля":5, "Глиняна форма":1 },
      { "Середній самородок":20, "Вугілля":5, "Глиняна форма":1 },
      { "Малий самородок":30, "Вугілля":5, "Глиняна форма":1 }
    ],
    "Злиток срібла": { "Срібна руда":10, "Вугілля":5, "Глиняна форма":1 },
    "Злиток міді": { "Мідна руда":10, "Вугілля":5, "Глиняна форма":1 },
    "Злиток свинцю": { "Свинцева руда":10, "Вугілля":5, "Глиняна форма":1 },
    "Злиток латуні": { "Злиток міді":1, "Злиток цинку":1, "Вугілля":5, "Глиняна форма":1 },
    "Злиток цинку": { "Цинкова руда":10, "Вугілля":5, "Глиняна форма":1 }
  }
};

// DOM
const menu = document.getElementById('menu');
const items = document.getElementById('items');
const summary = document.getElementById('summary');
const qtyInput = document.getElementById('qty');
const goldSelector = document.getElementById('goldSelector');
const goldOption = document.getElementById('goldOption');

let currentCategory = '';
let currentItem = '';

// Хелпери
const isPart = (name) => Object.prototype.hasOwnProperty.call(data.parts, name);
const isIngot = (name) => Object.prototype.hasOwnProperty.call(data.ingots, name);

// Отримати рецепт з урахуванням варіанта золота
function getRecipe(name) {
  if (isPart(name)) return data.parts[name];
  if (isIngot(name)) {
    const r = data.ingots[name];
    if (Array.isArray(r)) {
      const idx = parseInt(goldOption.value) || 0;
      return r[idx] || r[0];
    }
    return r;
  }
  return null;
}

// Рекурсивне розгортання
function expand(name, count, base = {}, ingots = {}, components = {}) {
  if (isPart(name)) {
    components[name] = (components[name] || 0) + count;
    const recipe = getRecipe(name);
    for (const k in recipe) expand(k, recipe[k] * count, base, ingots, components);
  } else if (isIngot(name)) {
    ingots[name] = (ingots[name] || 0) + count;
    const recipe = getRecipe(name);
    for (const k in recipe) expand(k, recipe[k] * count, base, ingots, components);
  } else {
    base[name] = (base[name] || 0) + count;
  }
  return { base, ingots, components };
}

function renderItems() {
  items.innerHTML = '';
  const catData = data[currentCategory] || {};
  const keys = Object.keys(catData);
  if (keys.length === 0) {
    const d = document.createElement('div');
    d.className = 'item';
    d.textContent = 'Немає елементів у цій категорії';
    d.style.opacity = '0.8';
    items.appendChild(d);
    return;
  }
  keys.forEach(itemName => {
    const d = document.createElement('div');
    d.className = 'item';
    d.textContent = itemName;
    d.addEventListener('click', () => {
      currentItem = itemName;
      items.querySelectorAll('.item').forEach(el => el.classList.remove('active-item'));
      d.classList.add('active-item');
      showSummary();
    });
    items.appendChild(d);
  });
}

menu.querySelectorAll('div').forEach(node => {
  node.addEventListener('click', () => {
    const cat = node.dataset.category;
    if (!cat || !data[cat]) return;
    currentCategory = cat;
    menu.querySelectorAll('div').forEach(el => el.classList.remove('active'));
    node.classList.add('active');
    renderItems();
    summary.innerHTML = 'Виберіть предмет';
    goldSelector.style.display = 'none';
  });
});

function showSummary() {
  const qty = parseInt(qtyInput.value) || 1;
  const recipe = data[currentCategory][currentItem];
  let base = {}, ingots = {}, components = {};

  for (const k in recipe) {
    expand(k, recipe[k] * qty, base, ingots, components);
  }

  const usesGold = !!ingots["Злиток золота"] || currentItem === "Злиток золота";
  goldSelector.style.display = usesGold ? 'inline-flex' : 'none';

  let html = `<b>${currentItem} × ${qty}</b><br><br>`;

  const oreKeys = Object.keys(base).filter(k =>
    k.toLowerCase().includes('руда') || k.toLowerCase().includes('самородок') || k === 'Дерево'
  ).sort();
  const auxKeys = Object.keys(base).filter(k => !oreKeys.includes(k)).sort();

  html += `<span class="section-title">Руда та дерево:</span><br>`;
  if (oreKeys.length === 0) html += `• Немає<br>`;
  else oreKeys.forEach(k => html += `• ${k}: ${base[k]}<br>`);

  if (auxKeys.length > 0) {
    html += `<br><span class="section-title">Допоміжні базові:</span><br>`;
    auxKeys.forEach(k => html += `• ${k}: ${base[k]}<br>`);
  }

  html += `<br><span class="section-title">Злитки:</span><br>`;
  const ingKeys = Object.keys(ingots).sort();
  if (ingKeys.length === 0) html += `• Немає<br>`;
  else ingKeys.forEach(k => html += `• ${k}: ${ingots[k]}<br>`);

  html += `<br><span class="section-title">Компоненти:</span><br>`;
  const compKeys = Object.keys(components).sort();
  if (compKeys.length === 0) html += `• Немає<br>`;
  else compKeys.forEach(k => html += `• ${k}: ${components[k]}<br>`);

  summary.innerHTML = html;
}

qtyInput.addEventListener('input', () => { if (currentItem) showSummary(); });
goldOption.addEventListener('change', () => { if (currentItem) showSummary(); });

const first = menu.querySelector('div[data-category]');
if (first) first.click();
</script>
</body>
</html>






















